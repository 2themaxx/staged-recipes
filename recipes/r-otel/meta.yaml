{% set version = '0.2.0' %}
{% set posix = 'm2-' if win else '' %}

package:
  name: r-otel
  version: {{ version|replace("-", "_") }}

source:
  url:
    - {{ cran_mirror }}/src/contrib/otel_{{ version }}.tar.gz
    - {{ cran_mirror }}/src/contrib/Archive/otel/otel_{{ version }}.tar.gz
  sha256: ef8afe5a1bc8074bbeb8a84134699ef348a1f8ac629ffba25ee43ea7bcd8dd17

build:
  number: 0
  noarch: generic
  rpaths:
    - lib/R/lib/
    - lib/
  missing_dso_whitelist:
    - '*/R.dll'        # [win]
    - '*/Rblas.dll'    # [win]
    - '*/Rlapack.dll'  # [win]

requirements:
  build:
    - {{ posix }}zip               # [win]
    - cross-r-base {{ r_base }}    # [build_platform != target_platform]
  host:
    - r-base
  run:
    - r-base

test:
  commands:
    - $R -e "library('otel')"           # [not win]
    - "\"%R%\" -e \"library('otel')\""  # [win]

about:
  home: https://otel.r-lib.org
  dev_url: https://github.com/r-lib/otel
  license: MIT
  summary: 'High-quality, ubiquitous, and portable telemetry to enable effective observability.
    OpenTelemetry is a collection of tools, APIs, and SDKs used to instrument, generate,
    collect, and export telemetry data (metrics, logs, and traces) for analysis in order
    to understand your software''s performance and behavior. This package implements
    the OpenTelemetry API: <https://opentelemetry.io/docs/specs/otel/>. Use this package
    as a dependency if you want to instrument your R package for OpenTelemetry.'
  license_family: MIT
  license_file:
    - '{{ environ["PREFIX"] }}/lib/R/share/licenses/MIT'
    - LICENSE

extra:
  recipe-maintainers:
    - conda-forge/r
